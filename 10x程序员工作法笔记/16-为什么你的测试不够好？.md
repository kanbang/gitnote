# 16 | 为什么你的测试不够好？

## 笔记

**将复杂的测试拆分成简单的测试, 测试才有可能做好**.

### 简单的测试

谁能保证测试的正确性.

**把测试写简单, 简单到一目了然, 不需要证明它的正确性**

### 测试的阶段

1. 前置准备
2. 执行
3. 断言
4. 清理

#### 前置准备

准备执行部分所需的依赖. 如一个类所依赖的组件, 调用方法所需要的参数.

#### 断言

断言是我们预期, 就是这段代码执行出来怎么算是对的.

#### 清理

如果测试用到任务资源, 都可以在这里释放掉.

### 测试的坏味道

多写几个测试, 每个测试覆盖一种场景.

测试要简单, 最好测试内部不需要在写`if-else`.

### 一段旅程(A-TRIP)

好的测试.

* **A**utomatic, 自动化
* **T**horough, 全面的
* **R**epeatable, 可重复的
* **I**ndependent, 独立的
* **P**rofessiona, 专业的

#### 自动化

把测试尽可能交给机器执行, 人工参与的部分越少越好.

#### 全面的

应该尽可能用测试覆盖各种场景.

* 写代码之前, 要考虑各种场景, 正常的, 异常的, 各种边界条件.
* 写完代码之后, 我们要看测试是否覆盖了所有的代码和所有的分支.

#### 可重复的

测试本身不应该依赖于任何不在控制之下的环境.

测试反复运行, 结果应该是一样的.

#### 独立的

测试和测试之间不应该有任何依赖. 不能假设测试是按照编写顺序运行的.

#### 专业的 

测试代码, 也是代码, 也要按照代码的标准去维护.

### 总结

**编写可测试的代码**

**要想写好测试, 就要写简单的测试**

## 扩展